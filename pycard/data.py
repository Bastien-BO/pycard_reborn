"""
All enum and datas used to perform card validation
"""
import re
from enum import Enum


class Brand(Enum):
    """
    All regex associated to card brands
    """

    amex = re.compile(r'^3[47]\d{13}$')
    dankort = re.compile(r'^(5019)\d{12}$')
    diners = re.compile(r'^3(?:0[0-5]|[68][0-9])[0-9]{11}$')
    discover = re.compile(r'^(6011|65\d{2})\d{12}$')
    jcb = re.compile(r'^(?:2131|1800|35\d{3})\d{11}$')
    mastercard = re.compile(r'''
                    ^(5[1-5]\d{4}|677189)\d{10}$|  # Traditional 5-series + RU support
                    ^(222[1-9]|2[3-6]\d{2}|27[0-1]\d|2720)\d{12}$  # 2016 2-series
                ''', re.VERBOSE)
    maestro = re.compile(r'^(?:5[0678]\d\d|6304|6390|67\d\d)\d{8,15}$')
    visa = re.compile(r'^4\d{12}(\d{3})?$')


class FriendlyBrand(Enum):
    """
    More user-friendly card brand matching
    """

    amex = 'American Express'
    dankort = 'Dankort'
    diners = 'Diners Club'
    discover = 'Discover'
    jcb = 'JCB'
    maestro = 'Maestro'
    mastercard = 'MasterCard'
    unknown = 'unknown'
    visa = 'Visa'


TESTS_CARDS = (
    '30569309025904',
    '3530111333300000',
    '371449635398431',
    '378282246310005',
    '378734493671000',
    '38520000023237',
    '4000000000000002',
    '4000000000000077',
    '4000000000000259',
    '4000000000001976',
    '4000000000003055',
    '4000000000003220',
    '4000000000005423',
    '4000000000009979',
    '4000000000009987',
    '4000000000009995',
    '4000000360000006',
    '4000000400000008',
    '4000000560000004',
    '4000000760000002',
    '4000001240000000',
    '4000001560000002',
    '4000002080000001',
    '4000002500000003',
    '4000002760000016',
    '4000003440000004',
    '4000003720000005',
    '4000003800000008',
    '4000003920000003',
    '4000004420000006',
    '4000004840000008',
    '4000005280000002',
    '4000005540000008',
    '4000005780000007',
    '4000006200000007',
    '4000006430000009',
    '4000007020000003',
    '4000007240000007',
    '4000007520000008',
    '4000007560000009',
    '4000008260000000',
    '4012888888881881',
    '4111111111111111',
    '4222222222222',
    '4242424242424242',
    '4444333322221111',
    '5105105105105100',
    '5105105105105100',
    '5200828282828210',
    '555555555554444',
    '5555555555554444',
    '6011000990139424',
    '6011111111111117',
)
